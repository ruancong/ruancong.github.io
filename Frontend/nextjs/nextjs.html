<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.19" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme='dark'] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background-color: var(--vp-c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme')
      const systemDarkMode =
        'matchMedia' in window
          ? window.matchMedia('(prefers-color-scheme: dark)').matches
          : false

      if (userMode === 'light') {
        document.documentElement.dataset.theme = 'light'
      } else if (userMode === 'dark' || systemDarkMode) {
        document.documentElement.dataset.theme = 'dark'
      }
    </script>
    <link rel="icon" href="/images/logo.svg"><title>Project Structure | Notes</title><meta name="description" content="Daily Learning Notes">
    <link rel="preload" href="/assets/style-CMopnafn.css" as="style"><link rel="stylesheet" href="/assets/style-CMopnafn.css">
    <link rel="modulepreload" href="/assets/app-BNa-KI3k.js"><link rel="modulepreload" href="/assets/nextjs.html-CTZxptDV.js">
    <link rel="prefetch" href="/assets/index.html-DqTSqkxj.js" as="script"><link rel="prefetch" href="/assets/commands.html-CwcxaWls.js" as="script"><link rel="prefetch" href="/assets/linux.html-CafUWy-8.js" as="script"><link rel="prefetch" href="/assets/MinIO.html-B6ZC3diE.js" as="script"><link rel="prefetch" href="/assets/PostgreSQL.html-BYECVLMw.js" as="script"><link rel="prefetch" href="/assets/docker.html-Z6qHvNjB.js" as="script"><link rel="prefetch" href="/assets/forget-lock-psw.html-DFzZzeF8.js" as="script"><link rel="prefetch" href="/assets/raft.html-DLxLRSZU.js" as="script"><link rel="prefetch" href="/assets/split-brain.html-CEsXkQLB.js" as="script"><link rel="prefetch" href="/assets/gemini_manual.html-m1b6D6LU.js" as="script"><link rel="prefetch" href="/assets/k8s.html-QmzxEhpT.js" as="script"><link rel="prefetch" href="/assets/network-basis.html-Caq0FIcK.js" as="script"><link rel="prefetch" href="/assets/问题解决.html-CB8quQnG.js" as="script"><link rel="prefetch" href="/assets/English-Grammar.html-BtC2vMes.js" as="script"><link rel="prefetch" href="/assets/英语句子解析.html-CzlsaVJP.js" as="script"><link rel="prefetch" href="/assets/语法学习.html-Cd5wm16b.js" as="script"><link rel="prefetch" href="/assets/template.html-C_ACYhog.js" as="script"><link rel="prefetch" href="/assets/react-router.html-DOUaD5Hw.js" as="script"><link rel="prefetch" href="/assets/react.html-Dy5y2Vdj.js" as="script"><link rel="prefetch" href="/assets/spingboot-3.x.html-BLwDsMYs.js" as="script"><link rel="prefetch" href="/assets/05-20.html-Dso6mw45.js" as="script"><link rel="prefetch" href="/assets/05-21.html-FV0RB8K6.js" as="script"><link rel="prefetch" href="/assets/05-22.html-C-2WQoCn.js" as="script"><link rel="prefetch" href="/assets/05-23.html-DZma4BGy.js" as="script"><link rel="prefetch" href="/assets/02-26.html-BfRN2l8j.js" as="script"><link rel="prefetch" href="/assets/01-03.html-Bf5cDfEJ.js" as="script"><link rel="prefetch" href="/assets/01-08.html-Bs4CAqof.js" as="script"><link rel="prefetch" href="/assets/01-10.html-DDnO_fEM.js" as="script"><link rel="prefetch" href="/assets/01-15.html-0NouZ2Pn.js" as="script"><link rel="prefetch" href="/assets/07-09.html-BzFu1V6t.js" as="script"><link rel="prefetch" href="/assets/07-10.html-DO7qO2zV.js" as="script"><link rel="prefetch" href="/assets/07-11.html-DdQ04v55.js" as="script"><link rel="prefetch" href="/assets/07-12.html-n32kiKjN.js" as="script"><link rel="prefetch" href="/assets/07-13.html-QCwB-Cce.js" as="script"><link rel="prefetch" href="/assets/07-14.html-D1IKz5pq.js" as="script"><link rel="prefetch" href="/assets/07-15.html-KwE17LT9.js" as="script"><link rel="prefetch" href="/assets/07-16.html-DJoIkwrs.js" as="script"><link rel="prefetch" href="/assets/09-03.html-BOrs-Zzb.js" as="script"><link rel="prefetch" href="/assets/404.html-BOxcU_kb.js" as="script"><link rel="prefetch" href="/assets/VocabularyAudio-4C1PZdpY.js" as="script"><link rel="prefetch" href="/assets/setupDevtools-7MC2TMWH-BeImLtqr.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="vp-theme-container external-link-icon" vp-container><!--[--><header class="vp-navbar" vp-navbar><div class="vp-toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a class="route-link" href="/"><img class="vp-site-logo" src="/images/logo.svg" alt="Notes"><span class="vp-site-name vp-hide-mobile" aria-hidden="true">Notes</span></a></span><div class="vp-navbar-items-wrapper" style=""><!--[--><!--]--><nav class="vp-navbar-items vp-hide-mobile" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/" aria-label="首页"><!---->首页<!----></a></div><div class="vp-navbar-item"><a class="auto-link external-link" href="https://github.com/ruancong/ruancong.github.io" aria-label="GitHub" rel="noopener noreferrer" target="_blank"><!---->GitHub<!----></a></div><!--]--></nav><!--[--><!--]--><button type="button" class="vp-toggle-color-mode-button" title="toggle color mode"><svg class="light-icon" viewbox="0 0 32 32" style=""><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg class="dark-icon" viewbox="0 0 32 32" style="display:none;"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="vp-sidebar-mask"></div><!--[--><aside class="vp-sidebar" vp-sidebar><nav class="vp-navbar-items" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/" aria-label="首页"><!---->首页<!----></a></div><div class="vp-navbar-item"><a class="auto-link external-link" href="https://github.com/ruancong/ruancong.github.io" aria-label="GitHub" rel="noopener noreferrer" target="_blank"><!---->GitHub<!----></a></div><!--]--></nav><!--[--><!--]--><ul class="vp-sidebar-items"><!--[--><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading">Project Structure <!----></p><!----></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="vp-page"><!--[--><!--]--><div vp-content><!--[--><!--]--><div><h1 id="project-structure" tabindex="-1"><a class="header-anchor" href="#project-structure"><span>Project Structure</span></a></h1><h2 id="folder-and-file-conversions" tabindex="-1"><a class="header-anchor" href="#folder-and-file-conversions"><span>Folder and file conversions</span></a></h2><h3 id="top-level-folders" tabindex="-1"><a class="header-anchor" href="#top-level-folders"><span>Top-level folders</span></a></h3><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><a href="https://nextjs.org/docs/app" target="_blank" rel="noopener noreferrer"><code>app</code></a></td><td>App Router</td></tr><tr><td><a href="https://nextjs.org/docs/pages/building-your-application/routing" target="_blank" rel="noopener noreferrer"><code>pages</code></a></td><td>Pages Router</td></tr><tr><td><a href="https://nextjs.org/docs/app/api-reference/file-conventions/public-folder" target="_blank" rel="noopener noreferrer"><code>public</code></a></td><td>Static assets to be served</td></tr><tr><td><a href="https://nextjs.org/docs/app/api-reference/file-conventions/src-folder" target="_blank" rel="noopener noreferrer"><code>src</code></a></td><td>Optional application source folder</td></tr></tbody></table><h3 id="top-level-files" tabindex="-1"><a class="header-anchor" href="#top-level-files"><span>Top-level files</span></a></h3><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><strong>Next.js</strong></td><td></td></tr><tr><td><a href="https://nextjs.org/docs/app/api-reference/config/next-config-js" target="_blank" rel="noopener noreferrer"><code>next.config.js</code></a></td><td>Configuration file for Next.js</td></tr><tr><td><a href="https://nextjs.org/docs/app/getting-started/installation#manual-installation" target="_blank" rel="noopener noreferrer"><code>package.json</code></a></td><td>Project dependencies and scripts</td></tr><tr><td><a href="https://nextjs.org/docs/app/guides/instrumentation" target="_blank" rel="noopener noreferrer"><code>instrumentation.ts</code></a></td><td>OpenTelemetry and Instrumentation file</td></tr><tr><td><a href="https://nextjs.org/docs/app/api-reference/file-conventions/middleware" target="_blank" rel="noopener noreferrer"><code>middleware.ts</code></a></td><td>Next.js request middleware</td></tr><tr><td><a href="https://nextjs.org/docs/app/guides/environment-variables" target="_blank" rel="noopener noreferrer"><code>.env</code></a></td><td>Environment variables</td></tr><tr><td><a href="https://nextjs.org/docs/app/guides/environment-variables" target="_blank" rel="noopener noreferrer"><code>.env.local</code></a></td><td>Local environment variables</td></tr><tr><td><a href="https://nextjs.org/docs/app/guides/environment-variables" target="_blank" rel="noopener noreferrer"><code>.env.production</code></a></td><td>Production environment variables</td></tr><tr><td><a href="https://nextjs.org/docs/app/guides/environment-variables" target="_blank" rel="noopener noreferrer"><code>.env.development</code></a></td><td>Development environment variables</td></tr><tr><td><a href="https://nextjs.org/docs/app/api-reference/config/eslint" target="_blank" rel="noopener noreferrer"><code>.eslintrc.json</code></a></td><td>Configuration file for ESLint</td></tr><tr><td><code>.gitignore</code></td><td>Git files and folders to ignore</td></tr><tr><td><code>next-env.d.ts</code></td><td>TypeScript declaration file for Next.js</td></tr><tr><td><code>tsconfig.json</code></td><td>Configuration file for TypeScript</td></tr><tr><td><code>jsconfig.json</code></td><td>Configuration file for JavaScript</td></tr></tbody></table><h3 id="routing-files" tabindex="-1"><a class="header-anchor" href="#routing-files"><span>Routing Files</span></a></h3><table><thead><tr><th></th><th></th><th></th></tr></thead><tbody><tr><td><a href="https://nextjs.org/docs/app/api-reference/file-conventions/layout" target="_blank" rel="noopener noreferrer"><code>layout</code></a></td><td><code>.js</code> <code>.jsx</code> <code>.tsx</code></td><td>Layout</td></tr><tr><td><a href="https://nextjs.org/docs/app/api-reference/file-conventions/page" target="_blank" rel="noopener noreferrer"><code>page</code></a></td><td><code>.js</code> <code>.jsx</code> <code>.tsx</code></td><td>Page</td></tr><tr><td><a href="https://nextjs.org/docs/app/api-reference/file-conventions/loading" target="_blank" rel="noopener noreferrer"><code>loading</code></a></td><td><code>.js</code> <code>.jsx</code> <code>.tsx</code></td><td>Loading UI</td></tr><tr><td><a href="https://nextjs.org/docs/app/api-reference/file-conventions/not-found" target="_blank" rel="noopener noreferrer"><code>not-found</code></a></td><td><code>.js</code> <code>.jsx</code> <code>.tsx</code></td><td>Not found UI</td></tr><tr><td><a href="https://nextjs.org/docs/app/api-reference/file-conventions/error" target="_blank" rel="noopener noreferrer"><code>error</code></a></td><td><code>.js</code> <code>.jsx</code> <code>.tsx</code></td><td>Error UI</td></tr><tr><td><a href="https://nextjs.org/docs/app/api-reference/file-conventions/error#global-error" target="_blank" rel="noopener noreferrer"><code>global-error</code></a></td><td><code>.js</code> <code>.jsx</code> <code>.tsx</code></td><td>Global error UI</td></tr><tr><td><a href="https://nextjs.org/docs/app/api-reference/file-conventions/route" target="_blank" rel="noopener noreferrer"><code>route</code></a></td><td><code>.js</code> <code>.ts</code></td><td>API endpoint</td></tr><tr><td><a href="https://nextjs.org/docs/app/api-reference/file-conventions/template" target="_blank" rel="noopener noreferrer"><code>template</code></a></td><td><code>.js</code> <code>.jsx</code> <code>.tsx</code></td><td>Re-rendered layout</td></tr><tr><td><a href="https://nextjs.org/docs/app/api-reference/file-conventions/default" target="_blank" rel="noopener noreferrer"><code>default</code></a></td><td><code>.js</code> <code>.jsx</code> <code>.tsx</code></td><td>Parallel route fallback page</td></tr></tbody></table><h3 id="nested-routes" tabindex="-1"><a class="header-anchor" href="#nested-routes"><span>Nested routes</span></a></h3><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><code>folder</code></td><td>Route segment</td></tr><tr><td><code>folder/folder</code></td><td>Nested route segment</td></tr></tbody></table><h3 id="dynamic-routes" tabindex="-1"><a class="header-anchor" href="#dynamic-routes"><span>Dynamic routes</span></a></h3><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><a href="https://nextjs.org/docs/app/api-reference/file-conventions/dynamic-routes#convention" target="_blank" rel="noopener noreferrer"><code>[folder]</code></a></td><td>Dynamic route segment</td></tr><tr><td><a href="https://nextjs.org/docs/app/api-reference/file-conventions/dynamic-routes#catch-all-segments" target="_blank" rel="noopener noreferrer"><code>[...folder]</code></a></td><td>Catch-all route segment</td></tr><tr><td><a href="https://nextjs.org/docs/app/api-reference/file-conventions/dynamic-routes#optional-catch-all-segments" target="_blank" rel="noopener noreferrer"><code>[[...folder]]</code></a></td><td>Optional catch-all route segment</td></tr></tbody></table><h3 id="route-groups-and-private-folders" tabindex="-1"><a class="header-anchor" href="#route-groups-and-private-folders"><span>Route Groups and private folders</span></a></h3><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><a href="https://nextjs.org/docs/app/api-reference/file-conventions/route-groups#convention" target="_blank" rel="noopener noreferrer"><code>(folder)</code></a></td><td>Group routes without affecting routing</td></tr><tr><td><a href="https://nextjs.org/docs/app/getting-started/project-structure#private-folders" target="_blank" rel="noopener noreferrer"><code>_folder</code></a></td><td>Opt folder and all child segments out of routing</td></tr></tbody></table><p>Route Groups can be nested.</p><h4 id="example" tabindex="-1"><a class="header-anchor" href="#example"><span>Example</span></a></h4><ul><li><p><strong>Organize routes without affecting the URL path</strong></p><p><img src="/assets/image-20250620171433724-DHnNi6UG.png" alt="image-20250620171433724"></p><p>Even though routes inside <code>(marketing)</code> and <code>(shop)</code> share the same URL hierarchy, you can create a different layout for each group by adding a <code>layout.js</code> file inside their folders.</p><p><img src="/assets/image-20250620171456302-BlmKEYws.png" alt="image-20250620171456302"></p></li></ul><h3 id="parallel-and-intercepted-routes" tabindex="-1"><a class="header-anchor" href="#parallel-and-intercepted-routes"><span>Parallel and Intercepted Routes</span></a></h3><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><a href="https://nextjs.org/docs/app/api-reference/file-conventions/parallel-routes#slots" target="_blank" rel="noopener noreferrer"><code>@folder</code></a></td><td>Named slot</td></tr><tr><td><a href="https://nextjs.org/docs/app/api-reference/file-conventions/intercepting-routes#convention" target="_blank" rel="noopener noreferrer"><code>(.)folder</code></a></td><td>Intercept same level</td></tr><tr><td><a href="https://nextjs.org/docs/app/api-reference/file-conventions/intercepting-routes#convention" target="_blank" rel="noopener noreferrer"><code>(..)folder</code></a></td><td>Intercept one level above</td></tr><tr><td><a href="https://nextjs.org/docs/app/api-reference/file-conventions/intercepting-routes#convention" target="_blank" rel="noopener noreferrer"><code>(..)(..)folder</code></a></td><td>Intercept two levels above</td></tr><tr><td><a href="https://nextjs.org/docs/app/api-reference/file-conventions/intercepting-routes#convention" target="_blank" rel="noopener noreferrer"><code>(...)folder</code></a></td><td>Intercept from root</td></tr></tbody></table><h3 id="metadata-file-conventions" tabindex="-1"><a class="header-anchor" href="#metadata-file-conventions"><span>Metadata file conventions</span></a></h3><h4 id="app-icons" tabindex="-1"><a class="header-anchor" href="#app-icons"><span>App icons</span></a></h4><table><thead><tr><th></th><th></th><th></th></tr></thead><tbody><tr><td><a href="https://nextjs.org/docs/app/api-reference/file-conventions/metadata/app-icons#favicon" target="_blank" rel="noopener noreferrer"><code>favicon</code></a></td><td><code>.ico</code></td><td>Favicon file</td></tr><tr><td><a href="https://nextjs.org/docs/app/api-reference/file-conventions/metadata/app-icons#icon" target="_blank" rel="noopener noreferrer"><code>icon</code></a></td><td><code>.ico</code> <code>.jpg</code> <code>.jpeg</code> <code>.png</code> <code>.svg</code></td><td>App Icon file</td></tr><tr><td><a href="https://nextjs.org/docs/app/api-reference/file-conventions/metadata/app-icons#generate-icons-using-code-js-ts-tsx" target="_blank" rel="noopener noreferrer"><code>icon</code></a></td><td><code>.js</code> <code>.ts</code> <code>.tsx</code></td><td>Generated App Icon</td></tr><tr><td><a href="https://nextjs.org/docs/app/api-reference/file-conventions/metadata/app-icons#apple-icon" target="_blank" rel="noopener noreferrer"><code>apple-icon</code></a></td><td><code>.jpg</code> <code>.jpeg</code>, <code>.png</code></td><td>Apple App Icon file</td></tr><tr><td><a href="https://nextjs.org/docs/app/api-reference/file-conventions/metadata/app-icons#generate-icons-using-code-js-ts-tsx" target="_blank" rel="noopener noreferrer"><code>apple-icon</code></a></td><td><code>.js</code> <code>.ts</code> <code>.tsx</code></td><td>Generated Apple App Icon</td></tr></tbody></table><h4 id="seo" tabindex="-1"><a class="header-anchor" href="#seo"><span>SEO</span></a></h4><table><thead><tr><th></th><th></th><th></th></tr></thead><tbody><tr><td><a href="https://nextjs.org/docs/app/api-reference/file-conventions/metadata/sitemap#sitemap-files-xml" target="_blank" rel="noopener noreferrer"><code>sitemap</code></a></td><td><code>.xml</code></td><td>Sitemap file</td></tr><tr><td><a href="https://nextjs.org/docs/app/api-reference/file-conventions/metadata/sitemap#generating-a-sitemap-using-code-js-ts" target="_blank" rel="noopener noreferrer"><code>sitemap</code></a></td><td><code>.js</code> <code>.ts</code></td><td>Generated Sitemap</td></tr><tr><td><a href="https://nextjs.org/docs/app/api-reference/file-conventions/metadata/robots#static-robotstxt" target="_blank" rel="noopener noreferrer"><code>robots</code></a></td><td><code>.txt</code></td><td>Robots file</td></tr><tr><td><a href="https://nextjs.org/docs/app/api-reference/file-conventions/metadata/robots#generate-a-robots-file" target="_blank" rel="noopener noreferrer"><code>robots</code></a></td><td><code>.js</code> <code>.ts</code></td><td>Generated Robots file</td></tr></tbody></table><h3 id="organizing-your-project" tabindex="-1"><a class="header-anchor" href="#organizing-your-project"><span>Organizing your project</span></a></h3><h4 id="component-hierarchy" tabindex="-1"><a class="header-anchor" href="#component-hierarchy"><span>Component hierarchy</span></a></h4><p>The components defined in special files are rendered in a specific hierarchy:</p><ul><li><code>layout.js</code></li><li><code>template.js</code></li><li><code>error.js</code> (React error boundary)</li><li><code>loading.js</code> (React suspense boundary)</li><li><code>not-found.js</code> (React error boundary)</li><li><code>page.js</code> or nested <code>layout.js</code></li></ul><p><img src="/assets/image-20250620115540425-BMjxBaYh.png" alt="image-20250620115540425"></p><p>The components of a route segment will be nested <strong>inside</strong> the components of its parent segment.</p><p><img src="/assets/image-20250620115619147-BbOPDQwk.png" alt="image-20250620115619147"></p><h4 id="colocation" tabindex="-1"><a class="header-anchor" href="#colocation"><span>Colocation</span></a></h4><p>A route is <strong>not publicly accessible</strong> until a <code>page.js</code> or <code>route.js</code> file is added to a route segment.</p><p><img src="/assets/image-20250620115715915-DP0YEkA2.png" alt="image-20250620115715915"></p><p>And, even when a route is made publicly accessible, only the <strong>content returned</strong> by <code>page.js</code> or <code>route.js</code> is sent to the client.</p><p><img src="/assets/image-20250620115803639-D5pnRa3K.png" alt="image-20250620115803639"></p><h4 id="private-folders" tabindex="-1"><a class="header-anchor" href="#private-folders"><span>Private folders</span></a></h4><p>Private folders can be created by prefixing a folder with an underscore: <code>_folderName</code></p><p>his indicates the folder is a private implementation detail and should not be considered by the routing system, thereby <strong>opting the folder and all its subfolders</strong> out of routing.</p><p><img src="/assets/image-20250620135923483-BB22d1fN.png" alt="image-20250620135923483"></p><h4 id="route-groups" tabindex="-1"><a class="header-anchor" href="#route-groups"><span>Route groups</span></a></h4><p>Route groups can be created by wrapping a folder in parenthesis: <code>(folderName)</code></p><p>This indicates the folder is for organizational purposes and should <strong>not be included</strong> in the route&#39;s URL path.</p><p><img src="/assets/image-20250620140531898-COoqxcMF.png" alt="image-20250620140531898"></p><h5 id="examples" tabindex="-1"><a class="header-anchor" href="#examples"><span>Examples</span></a></h5><ul><li><p><strong>Creating multiple root layouts</strong></p><p>To create multiple <a href="https://nextjs.org/docs/app/api-reference/file-conventions/layout#root-layout" target="_blank" rel="noopener noreferrer">root layouts</a>, remove the top-level <code>layout.js</code> file, and add a <code>layout.js</code> file inside each route group. This is useful for partitioning an application into sections that have a completely different UI or experience. The <code>&lt;html&gt;</code> and <code>&lt;body&gt;</code> tags need to be added to each root layout.</p><p><img src="/assets/image-20250620150130806-CYnT1pLv.png" alt="image-20250620150130806"></p><p>In the example above, both <code>(marketing)</code> and <code>(shop)</code> have their own root layout.</p></li></ul><h1 id="layouts-and-pages" tabindex="-1"><a class="header-anchor" href="#layouts-and-pages"><span>Layouts and Pages</span></a></h1><h2 id="creating-a-page" tabindex="-1"><a class="header-anchor" href="#creating-a-page"><span>Creating a page</span></a></h2><p>A <strong>page</strong> is UI that is rendered on a specific route.</p><p><img src="/assets/image-20250623105910942-BmZMuNg3.png" alt="image-20250623105910942"></p><h2 id="creating-a-layout" tabindex="-1"><a class="header-anchor" href="#creating-a-layout"><span>Creating a layout</span></a></h2><p>A layout is UI that is <strong>shared</strong> between multiple pages.</p><div class="language-tsx line-numbers-mode" data-highlighter="prismjs" data-ext="tsx" data-title="tsx"><pre><code><span class="line"><span class="token comment">// app/layout.tsx</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">DashboardLayout</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">  children<span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">  children<span class="token operator">:</span> React<span class="token punctuation">.</span>ReactNode</span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">return</span> <span class="token punctuation">(</span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text"></span>
<span class="line">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span><span class="token plain-text"></span>
<span class="line">        </span><span class="token punctuation">{</span><span class="token comment">/* Layout UI */</span><span class="token punctuation">}</span><span class="token plain-text"></span>
<span class="line">        </span><span class="token punctuation">{</span><span class="token comment">/* Place children where you want to render a page or nested layout */</span><span class="token punctuation">}</span><span class="token plain-text"></span>
<span class="line">        </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>main</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>children<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>main</span><span class="token punctuation">&gt;</span></span><span class="token plain-text"></span>
<span class="line">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span><span class="token plain-text"></span>
<span class="line">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">  <span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The layout above is called a <a href="https://nextjs.org/docs/app/api-reference/file-conventions/layout#root-layout" target="_blank" rel="noopener noreferrer">root layout</a> because it&#39;s defined at the root of the <code>app</code> directory. The root layout is <strong>required</strong> and must contain <code>html</code> and <code>body</code> tags.</p><h2 id="creating-a-nested-route" tabindex="-1"><a class="header-anchor" href="#creating-a-nested-route"><span>Creating a nested route</span></a></h2><p>A nested route is a route composed of multiple URL segments. For example, the <code>/blog/[slug]</code> route is composed of three segments:</p><ul><li><code>/</code> (Root Segment)</li><li><code>blog</code> (Segment)</li><li><code>[slug]</code> (Leaf Segment)</li></ul><p>In Next.js:</p><ul><li><strong>Folders</strong> are used to define the route segments that map to URL segments.</li><li><strong>Files</strong> (like <code>page</code> and <code>layout</code>) are used to create UI that is shown for a segment.</li></ul><h2 id="nesting-layouts" tabindex="-1"><a class="header-anchor" href="#nesting-layouts"><span>Nesting layouts</span></a></h2><p>For example, to create a layout for the <code>/blog</code> route, add a new <code>layout</code> file inside the <code>blog</code> folder.</p><p><img src="/assets/image-20250623150452533-vYJ8FeKI.png" alt="image-20250623150452533"></p><h2 id="creating-a-dynamic-segment" tabindex="-1"><a class="header-anchor" href="#creating-a-dynamic-segment"><span>Creating a dynamic segment</span></a></h2><p>To create a dynamic segment, wrap the segment (folder) name in square brackets: <code>[segmentName]</code>. For example, in the <code>app/blog/[slug]/page.tsx</code> route, the <code>[slug]</code> is the dynamic segment.</p><div class="language-tsx line-numbers-mode" data-highlighter="prismjs" data-ext="tsx" data-title="tsx"><pre><code><span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">BlogPostPage</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">  params<span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">  params<span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token punctuation">{</span> slug<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">}</span><span class="token operator">&gt;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">const</span> <span class="token punctuation">{</span> slug <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> params</span>
<span class="line">  <span class="token keyword">const</span> post <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getPost</span><span class="token punctuation">(</span>slug<span class="token punctuation">)</span></span>
<span class="line"> </span>
<span class="line">  <span class="token keyword">return</span> <span class="token punctuation">(</span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token plain-text"></span>
<span class="line">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>post<span class="token punctuation">.</span>title<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text"></span>
<span class="line">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>post<span class="token punctuation">.</span>content<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text"></span>
<span class="line">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">  <span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Dynamic Segments are passed as the <code>params</code> prop to <a href="https://nextjs.org/docs/app/api-reference/file-conventions/layout" target="_blank" rel="noopener noreferrer"><code>layout</code></a>, <a href="https://nextjs.org/docs/app/api-reference/file-conventions/page" target="_blank" rel="noopener noreferrer"><code>page</code></a>, <a href="https://nextjs.org/docs/app/api-reference/file-conventions/route" target="_blank" rel="noopener noreferrer"><code>route</code></a>, and <a href="https://nextjs.org/docs/app/api-reference/functions/generate-metadata#generatemetadata-function" target="_blank" rel="noopener noreferrer"><code>generateMetadata</code></a> functions.</p><blockquote><p>the <code>params</code> prop is a promise. In version 14 and earlier, <code>params</code> was a synchronous prop.</p></blockquote><h1 id="linking-and-navigating" tabindex="-1"><a class="header-anchor" href="#linking-and-navigating"><span>Linking and Navigating</span></a></h1><h2 id="server-rendering" tabindex="-1"><a class="header-anchor" href="#server-rendering"><span>Server Rendering</span></a></h2><p>There are two types of server rendering, based on <em>when</em> it happens:</p><ul><li><strong>Static Rendering (or Prerendering)</strong> happens at build time or during <a href="https://nextjs.org/docs/app/getting-started/caching-and-revalidating" target="_blank" rel="noopener noreferrer">revalidation</a> and the result is cached.</li><li><strong>Dynamic Rendering</strong> happens at request time in response to a client request.</li></ul><h2 id="prefetching" tabindex="-1"><a class="header-anchor" href="#prefetching"><span>Prefetching</span></a></h2><p>Prefetching is the process of loading a route in the background before the user navigates to it. This makes navigation between routes in your application feel instant, because by the time a user clicks on a link, the data to render the next route is already available client side.</p><p>Next.js automatically prefetches routes linked with the <a href="https://nextjs.org/docs/app/api-reference/components/link" target="_blank" rel="noopener noreferrer"><code>&lt;Link&gt;</code></a> when they enter the user&#39;s viewport.</p><h2 id="streaming" tabindex="-1"><a class="header-anchor" href="#streaming"><span>Streaming</span></a></h2><p>To use streaming, create a <code>loading.tsx</code> in your route folder:</p><p><img src="/assets/image-20250624112802944-CbA6tymK.png" alt="image-20250624112802944"></p><h2 id="what-can-make-transitions-slow" tabindex="-1"><a class="header-anchor" href="#what-can-make-transitions-slow"><span>What can make transitions slow?</span></a></h2><h3 id="slow-networks" tabindex="-1"><a class="header-anchor" href="#slow-networks"><span>Slow networks</span></a></h3><p>To improve perceived performance, you can use the <a href="https://nextjs.org/docs/app/api-reference/functions/use-link-status" target="_blank" rel="noopener noreferrer"><code>useLinkStatus</code> hook</a> to show inline visual feedback to the user (like spinners or text glimmers on the link) while a transition is in progress.</p><div class="language-tsx line-numbers-mode" data-highlighter="prismjs" data-ext="tsx" data-title="tsx"><pre><code><span class="line"><span class="token string">&#39;use client&#39;</span></span>
<span class="line"> </span>
<span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> useLinkStatus <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;next/link&#39;</span></span>
<span class="line"> </span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">LoadingIndicator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">const</span> <span class="token punctuation">{</span> pending <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useLinkStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token keyword">return</span> pending <span class="token operator">?</span> <span class="token punctuation">(</span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">role</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>status<span class="token punctuation">&quot;</span></span> <span class="token attr-name">aria-label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Loading<span class="token punctuation">&quot;</span></span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>spinner<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span></span>
<span class="line">  <span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">null</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><code>useLinkStatus</code> must be used within a descendant component of a <code>Link</code> component</p></blockquote><h1 id="server-and-client-components" tabindex="-1"><a class="header-anchor" href="#server-and-client-components"><span>Server and Client Components</span></a></h1><p>By default, layouts and pages are <a href="https://react.dev/reference/rsc/server-components" target="_blank" rel="noopener noreferrer">Server Components</a>, which lets you fetch data and render parts of your UI on the server, optionally cache the result, and stream it to the client. When you need interactivity or browser APIs, you can use <a href="https://react.dev/reference/rsc/use-client" target="_blank" rel="noopener noreferrer">Client Components</a> to layer in functionality.</p><h2 id="when-to-use-server-and-client-components" tabindex="-1"><a class="header-anchor" href="#when-to-use-server-and-client-components"><span>When to use Server and Client Components</span></a></h2><p>Use <strong>Client Components</strong> when you need:</p><ul><li><a href="https://react.dev/learn/managing-state" target="_blank" rel="noopener noreferrer">State</a> and <a href="https://react.dev/learn/responding-to-events" target="_blank" rel="noopener noreferrer">event handlers</a>. E.g. <code>onClick</code>, <code>onChange</code>.</li><li><a href="https://react.dev/learn/lifecycle-of-reactive-effects" target="_blank" rel="noopener noreferrer">Lifecycle logic</a>. E.g. <code>useEffect</code>.</li><li>Browser-only APIs. E.g. <code>localStorage</code>, <code>window</code>, <code>Navigator.geolocation</code>, etc.</li><li><a href="https://react.dev/learn/reusing-logic-with-custom-hooks" target="_blank" rel="noopener noreferrer">Custom hooks</a>.</li></ul><p>Use <strong>Server Components</strong> when you need:</p><ul><li>Fetch data from databases or APIs close to the source.</li><li>Use API keys, tokens, and other secrets without exposing them to the client.</li><li>Reduce the amount of JavaScript sent to the browser.</li><li>Improve the <a href="https://web.dev/fcp/" target="_blank" rel="noopener noreferrer">First Contentful Paint (FCP)</a>, and stream content progressively to the client.</li></ul><h2 id="examples-1" tabindex="-1"><a class="header-anchor" href="#examples-1"><span>Examples</span></a></h2><h3 id="using-client-components" tabindex="-1"><a class="header-anchor" href="#using-client-components"><span>Using Client Components</span></a></h3><p>You can create a Client Component by adding the <a href="https://react.dev/reference/react/use-client" target="_blank" rel="noopener noreferrer"><code>&quot;use client&quot;</code></a> directive at the top of the file, above your imports.</p><p>Once a file is marked with <code>&quot;use client&quot;</code>, <strong>all its imports and child components are considered part of the client bundle</strong>. This means you don&#39;t need to add the directive to every component that is intended for the client.</p><p><strong>Client components cannot be async functions.</strong></p><h3 id="passing-data-from-server-to-client-components" tabindex="-1"><a class="header-anchor" href="#passing-data-from-server-to-client-components"><span>Passing data from Server to Client Components</span></a></h3><p>You can pass data from Server Components to Client Components using props.</p><h3 id="interleaving-server-and-client-components" tabindex="-1"><a class="header-anchor" href="#interleaving-server-and-client-components"><span>Interleaving Server and Client Components</span></a></h3><p>You can pass Server Components as a prop to a Client Component. This allows you to visually nest server-rendered UI within Client components.</p><h3 id="context-providers" tabindex="-1"><a class="header-anchor" href="#context-providers"><span>Context providers</span></a></h3><p><a href="https://react.dev/learn/passing-data-deeply-with-context" target="_blank" rel="noopener noreferrer">React context</a> is commonly used to share global state like the current theme. However, React context is not supported in Server Components.</p><p>To use context, create a Client Component that accepts <code>children</code>:</p><h3 id="third-party-components" tabindex="-1"><a class="header-anchor" href="#third-party-components"><span>Third-party components</span></a></h3><p>When using a third-party component that relies on client-only features, you can wrap it in a Client Component to ensure it works as expected.</p><p>If you try to use <code>&lt;Carousel /&gt;</code> directly within a Server Component, you&#39;ll see an error. This is because Next.js doesn&#39;t know <code>&lt;Carousel /&gt;</code> is using client-only features.</p><p>To fix this, you can wrap third-party components that rely on client-only features in your own Client Components:</p><div class="language-tsx line-numbers-mode" data-highlighter="prismjs" data-ext="tsx" data-title="tsx"><pre><code><span class="line"><span class="token string">&#39;use client&#39;</span></span>
<span class="line"> </span>
<span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> Carousel <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;acme-carousel&#39;</span></span>
<span class="line"> </span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> Carousel</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Now, you can use <code>&lt;Carousel /&gt;</code> directly within a Server Component</p><h3 id="preventing-environment-poisoning" tabindex="-1"><a class="header-anchor" href="#preventing-environment-poisoning"><span>Preventing environment poisoning</span></a></h3><p>JavaScript modules can be shared between both Server and Client Components modules. This means it&#39;s possible to accidentally import server-only code into the client. For example, consider the following function:</p><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts" data-title="ts"><pre><code><span class="line"><span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&#39;https://external-service.com/data&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span></span>
<span class="line">    headers<span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">      authorization<span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">API_KEY</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"> </span>
<span class="line">  <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>This function contains an <code>API_KEY</code> that should never be exposed to the client.</p><p>In Next.js, only environment variables prefixed with <code>NEXT_PUBLIC_</code> are included in the client bundle. If variables are not prefixed, Next.js replaces them with an empty string.</p><p>As a result, even though <code>getData()</code> can be imported and executed on the client, it won&#39;t work as expected.</p><p>To prevent accidental usage in Client Components, you can use the <a href="https://www.npmjs.com/package/server-only" target="_blank" rel="noopener noreferrer"><code>server-only</code> package</a>.</p><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts" data-title="ts"><pre><code><span class="line"><span class="token keyword">import</span> <span class="token string">&#39;server-only&#39;</span></span>
<span class="line"> </span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&#39;https://external-service.com/data&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span></span>
<span class="line">    headers<span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">      authorization<span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">API_KEY</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"> </span>
<span class="line">  <span class="token keyword">return</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Now, if you try to import the module into a Client Component, there will be a build-time error.</p><h3 id="build-server-components" tabindex="-1"><a class="header-anchor" href="#build-server-components"><span>Build Server Components</span></a></h3><p>When running<code>npm run build</code>in Next.js, it attempts to pre-render pages. At this time, the local server is not actually running, so fetching from http://localhost:3000 will fail. There are two solutions:</p><ol><li>Set the page to dynamic rendering, preventing pre-rendering at build time</li><li>Set no-cache parameters when fetching: like [<code>await fetch(${baseUrl}/api/users, { cache: &quot;no-store&quot; });</code>]</li></ol><h1 id="fetching-data" tabindex="-1"><a class="header-anchor" href="#fetching-data"><span>Fetching data</span></a></h1><h2 id="server-components" tabindex="-1"><a class="header-anchor" href="#server-components"><span>Server Components</span></a></h2><p>You can fetch data in Server Components using:</p><ol><li>The <a href="https://nextjs.org/docs/app/getting-started/fetching-data#with-the-fetch-api" target="_blank" rel="noopener noreferrer"><code>fetch</code> API</a></li><li>An <a href="https://nextjs.org/docs/app/getting-started/fetching-data#with-an-orm-or-database" target="_blank" rel="noopener noreferrer">ORM or database</a></li></ol><h2 id="client-components" tabindex="-1"><a class="header-anchor" href="#client-components"><span>Client Components</span></a></h2><p>There are two ways to fetch data in Client Components, using:</p><ol><li>React&#39;s <a href="https://react.dev/reference/react/use" target="_blank" rel="noopener noreferrer"><code>use</code> hook</a></li><li>A community library like <a href="https://swr.vercel.app/" target="_blank" rel="noopener noreferrer">SWR</a> or <a href="https://tanstack.com/query/latest" target="_blank" rel="noopener noreferrer">React Query</a></li></ol><h2 id="examples-2" tabindex="-1"><a class="header-anchor" href="#examples-2"><span>Examples</span></a></h2><h3 id="sequential-data-fetching" tabindex="-1"><a class="header-anchor" href="#sequential-data-fetching"><span>Sequential data fetching</span></a></h3><div class="language-tsx line-numbers-mode" data-highlighter="prismjs" data-ext="tsx" data-title="tsx"><pre><code><span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span> params <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token comment">// These requests will be sequential</span></span>
<span class="line">  <span class="token keyword">const</span> <span class="token punctuation">{</span> username <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> params</span>
<span class="line">  <span class="token keyword">const</span> artist <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getArtist</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span></span>
<span class="line">  <span class="token keyword">const</span> albums <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getAlbums</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span></span>
<span class="line">  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>artist<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="parallel-data-fetching" tabindex="-1"><a class="header-anchor" href="#parallel-data-fetching"><span>Parallel data fetching</span></a></h3><div class="language-tsx line-numbers-mode" data-highlighter="prismjs" data-ext="tsx" data-title="tsx"><pre><code><span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">  params<span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">  params<span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token punctuation">{</span> username<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">}</span><span class="token operator">&gt;</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">const</span> <span class="token punctuation">{</span> username <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> params</span>
<span class="line">  <span class="token keyword">const</span> artistData <span class="token operator">=</span> <span class="token function">getArtist</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span></span>
<span class="line">  <span class="token keyword">const</span> albumsData <span class="token operator">=</span> <span class="token function">getAlbums</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span></span>
<span class="line"> </span>
<span class="line">  <span class="token comment">// Initiate both requests in parallel</span></span>
<span class="line">  <span class="token keyword">const</span> <span class="token punctuation">[</span>artist<span class="token punctuation">,</span> albums<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token builtin">Promise</span><span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span>artistData<span class="token punctuation">,</span> albumsData<span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="line"> </span>
<span class="line">  <span class="token keyword">return</span> <span class="token punctuation">(</span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text"></span>
<span class="line">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>artist<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span><span class="token plain-text"></span>
<span class="line">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Albums</span></span> <span class="token attr-name">list</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>albums<span class="token punctuation">}</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text"></span>
<span class="line">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">&gt;</span></span></span>
<span class="line">  <span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><strong>Good to know:</strong> If one request fails when using <code>Promise.all</code>, the entire operation will fail. To handle this, you can use the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/allSettled" target="_blank" rel="noopener noreferrer"><code>Promise.allSettled</code></a> method instead.</p></blockquote><h1 id="updating-data" tabindex="-1"><a class="header-anchor" href="#updating-data"><span>Updating data</span></a></h1><p>You can update data in Next.js using React&#39;s <a href="https://react.dev/reference/rsc/server-functions" target="_blank" rel="noopener noreferrer">Server Functions</a>.</p><h2 id="what-are-server-functions" tabindex="-1"><a class="header-anchor" href="#what-are-server-functions"><span>What are Server Functions?</span></a></h2><p>A <strong>Server Function</strong> is an asynchronous function that runs on the server. They can be called from client through a network request, which is why they must be asynchronous.</p><p>By convention, a Server Action is an async function used with <a href="https://react.dev/reference/react/startTransition" target="_blank" rel="noopener noreferrer"><code>startTransition</code></a>. This happens automatically when the function is:</p><ul><li>Passed to a <code>&lt;form&gt;</code> using the <code>action</code> prop.</li><li>Passed to a <code>&lt;button&gt;</code> using the <code>formAction</code> prop.</li></ul><h2 id="creating-server-functions" tabindex="-1"><a class="header-anchor" href="#creating-server-functions"><span>Creating Server Functions</span></a></h2><p>A Server Function can be defined by using the <a href="https://react.dev/reference/rsc/use-server" target="_blank" rel="noopener noreferrer"><code>use server</code></a> directive. You can place the directive at the top of an <strong>asynchronous</strong> function to mark the function as a Server Function, or at the top of a separate file to mark all exports of that file.</p><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts" data-title="ts"><pre><code><span class="line"><span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">createPost</span><span class="token punctuation">(</span>formData<span class="token operator">:</span> FormData<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token string">&#39;use server&#39;</span></span>
<span class="line">  <span class="token keyword">const</span> title <span class="token operator">=</span> formData<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;title&#39;</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token keyword">const</span> content <span class="token operator">=</span> formData<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;content&#39;</span><span class="token punctuation">)</span></span>
<span class="line"> </span>
<span class="line">  <span class="token comment">// Update data</span></span>
<span class="line">  <span class="token comment">// Revalidate cache</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"> </span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">deletePost</span><span class="token punctuation">(</span>formData<span class="token operator">:</span> FormData<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token string">&#39;use server&#39;</span></span>
<span class="line">  <span class="token keyword">const</span> id <span class="token operator">=</span> formData<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;id&#39;</span><span class="token punctuation">)</span></span>
<span class="line"> </span>
<span class="line">  <span class="token comment">// Update data</span></span>
<span class="line">  <span class="token comment">// Revalidate cache</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="server-components-1" tabindex="-1"><a class="header-anchor" href="#server-components-1"><span>Server Components</span></a></h3><p>Server Functions can be inlined in Server Components by adding the <code>&quot;use server&quot;</code> directive to the top of the function body:</p><div class="language-tsx line-numbers-mode" data-highlighter="prismjs" data-ext="tsx" data-title="tsx"><pre><code><span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token comment">// Server Action</span></span>
<span class="line">  <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">createPost</span><span class="token punctuation">(</span>formData<span class="token operator">:</span> FormData<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token string">&#39;use server&#39;</span></span>
<span class="line">    <span class="token comment">// ...</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"> </span>
<span class="line">  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span></span><span class="token punctuation">&gt;</span></span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="client-components-1" tabindex="-1"><a class="header-anchor" href="#client-components-1"><span>Client Components</span></a></h3><p>It&#39;s not possible to define Server Functions in Client Components. However, you can invoke them in Client Components by importing them from a file that has the <code>&quot;use server&quot;</code> directive at the top of it:</p><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts" data-title="ts"><pre><code><span class="line"><span class="token string">&#39;use server&#39;</span></span>
<span class="line"> </span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">createPost</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="passing-actions-as-props" tabindex="-1"><a class="header-anchor" href="#passing-actions-as-props"><span>Passing actions as props</span></a></h3><div class="language-tsx line-numbers-mode" data-highlighter="prismjs" data-ext="tsx" data-title="tsx"><pre><code><span class="line"><span class="token string">&#39;use client&#39;</span></span>
<span class="line"> </span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">ClientComponent</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">  updateItemAction<span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token function-variable function">updateItemAction</span><span class="token operator">:</span> <span class="token punctuation">(</span>formData<span class="token operator">:</span> FormData<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>updateItemAction<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span><span class="token comment">/* ... */</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="invoking-server-functions" tabindex="-1"><a class="header-anchor" href="#invoking-server-functions"><span>Invoking Server Functions</span></a></h2><p>There are two main ways you can invoke a Server Function:</p><ol><li><a href="https://nextjs.org/docs/app/getting-started/updating-data#forms" target="_blank" rel="noopener noreferrer">Forms</a> in Server and Client Components</li><li><a href="https://nextjs.org/docs/app/getting-started/updating-data#event-handlers" target="_blank" rel="noopener noreferrer">Event Handlers</a> and <a href="https://nextjs.org/docs/app/getting-started/updating-data#useeffect" target="_blank" rel="noopener noreferrer">useEffect</a> in Client Components</li></ol><h3 id="forms" tabindex="-1"><a class="header-anchor" href="#forms"><span>Forms</span></a></h3><p>React extends the HTML <code>&lt;form&gt;</code> element to allow Server Function to be invoked with the HTML <code>action</code> prop.</p><p>When invoked in a form, the function automatically receives the <a href="https://developer.mozilla.org/docs/Web/API/FormData/FormData" target="_blank" rel="noopener noreferrer"><code>FormData</code></a> object. You can extract the data using the native <a href="https://developer.mozilla.org/en-US/docs/Web/API/FormData#instance_methods" target="_blank" rel="noopener noreferrer"><code>FormData</code> methods</a>:</p><div class="language-tsx line-numbers-mode" data-highlighter="prismjs" data-ext="tsx" data-title="tsx"><pre><code><span class="line"><span class="token comment">// app/ui/form.tsx</span></span>
<span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> createPost <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@/app/actions&#39;</span></span>
<span class="line"> </span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">Form</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">return</span> <span class="token punctuation">(</span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>createPost<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text"></span>
<span class="line">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>title<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text"></span>
<span class="line">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>content<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text"></span>
<span class="line">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>submit<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Create</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text"></span>
<span class="line">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">  <span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts" data-title="ts"><pre><code><span class="line"><span class="token comment">// app/actions.ts</span></span>
<span class="line"><span class="token string">&#39;use server&#39;</span></span>
<span class="line"> </span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">createPost</span><span class="token punctuation">(</span>formData<span class="token operator">:</span> FormData<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">const</span> title <span class="token operator">=</span> formData<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;title&#39;</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token keyword">const</span> content <span class="token operator">=</span> formData<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;content&#39;</span><span class="token punctuation">)</span></span>
<span class="line"> </span>
<span class="line">  <span class="token comment">// Update data</span></span>
<span class="line">  <span class="token comment">// Revalidate cache</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="event-handlers" tabindex="-1"><a class="header-anchor" href="#event-handlers"><span>Event Handlers</span></a></h3><p>You can invoke a Server Function in a Client Component by using event handlers such as <code>onClick</code>.</p><h1 id="caching-and-revalidating" tabindex="-1"><a class="header-anchor" href="#caching-and-revalidating"><span>Caching and Revalidating</span></a></h1><p>Caching is a technique for storing the result of data fetching and other computations so that future requests for the same data can be served faster, without doing the work again. While revalidation allows you to update cache entries without having to rebuild your entire application.</p><p>Next.js provides a few APIs to handle caching and revalidation. This guide will walk you through when and how to use them.</p><ul><li><a href="https://nextjs.org/docs/app/getting-started/caching-and-revalidating#fetch" target="_blank" rel="noopener noreferrer"><code>fetch</code></a></li><li><a href="https://nextjs.org/docs/app/getting-started/caching-and-revalidating#unstable_cache" target="_blank" rel="noopener noreferrer"><code>unstable_cache</code></a></li><li><a href="https://nextjs.org/docs/app/getting-started/caching-and-revalidating#revalidatepath" target="_blank" rel="noopener noreferrer"><code>revalidatePath</code></a></li><li><a href="https://nextjs.org/docs/app/getting-started/caching-and-revalidating#revalidatetag" target="_blank" rel="noopener noreferrer"><code>revalidateTag</code></a></li></ul><h2 id="fetch" tabindex="-1"><a class="header-anchor" href="#fetch"><span>fetch</span></a></h2><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts" data-title="ts"><pre><code><span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&#39;https://...&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> cache<span class="token operator">:</span> <span class="token string">&#39;force-cache&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><strong>Good to know</strong>: Although <code>fetch</code> requests are not cached by default, Next.js will <a href="https://nextjs.org/docs/app/getting-started/partial-prerendering#static-rendering" target="_blank" rel="noopener noreferrer">prerender</a> routes that have <code>fetch</code> requests and cache the HTML. If you want to guarantee a route is <a href="https://nextjs.org/docs/app/getting-started/partial-prerendering#dynamic-rendering" target="_blank" rel="noopener noreferrer">dynamic</a>, use the <a href="https://nextjs.org/docs/app/api-reference/functions/connection" target="_blank" rel="noopener noreferrer"><code>connection</code> API</a>.</p></blockquote><p>To revalidate the data returned by a <code>fetch</code> request, you can use the <code>next.revalidate</code> option.</p><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts" data-title="ts"><pre><code><span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&#39;https://...&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> next<span class="token operator">:</span> <span class="token punctuation">{</span> revalidate<span class="token operator">:</span> <span class="token number">3600</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>This will revalidate the data after a specified amount of seconds.</p><p>Next.js extends the <a href="https://developer.mozilla.org/docs/Web/API/Fetch_API" target="_blank" rel="noopener noreferrer">Web <code>fetch()</code> API</a> to allow each request on the server to set its own persistent caching and revalidation semantics.</p></blockquote><h2 id="unstable-cache" tabindex="-1"><a class="header-anchor" href="#unstable-cache"><span>unstable_cache</span></a></h2><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts" data-title="ts"><pre><code><span class="line"><span class="token keyword">const</span> getCachedUser <span class="token operator">=</span> <span class="token function">unstable_cache</span><span class="token punctuation">(</span></span>
<span class="line">  <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">return</span> <span class="token function">getUserById</span><span class="token punctuation">(</span>userId<span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token punctuation">[</span>userId<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// add the user ID to the cache key</span></span>
<span class="line">  <span class="token punctuation">{</span></span>
<span class="line">    tags<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;user&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">    revalidate<span class="token operator">:</span> <span class="token number">3600</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The function accepts a third optional object to define how the cache should be revalidated. It accepts:</p><ul><li><code>tags</code>: an array of tags used by Next.js to revalidate the cache.</li><li><code>revalidate</code>: the number of seconds after cache should be revalidated.</li></ul><h2 id="revalidatetag" tabindex="-1"><a class="header-anchor" href="#revalidatetag"><span>revalidateTag</span></a></h2><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts" data-title="ts"><pre><code><span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> revalidateTag <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;next/cache&#39;</span></span>
<span class="line"> </span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">updateUser</span><span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token comment">// Mutate data</span></span>
<span class="line">  <span class="token function">revalidateTag</span><span class="token punctuation">(</span><span class="token string">&#39;user&#39;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>You can reuse the same tag in multiple functions to revalidate them all at once. <strong>In other words,</strong> you can revalidate tags <strong>used in the options of the <code>fetch</code> and <code>unstable_cache</code> methods.</strong></p><h2 id="revalidatepath" tabindex="-1"><a class="header-anchor" href="#revalidatepath"><span>revalidatePath</span></a></h2><p><code>revalidatePath</code> is used to revalidate a route and following an event. To use it, call it in a <a href="https://nextjs.org/docs/app/api-reference/file-conventions/route" target="_blank" rel="noopener noreferrer">Route Handler</a> or Server Action:</p><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts" data-title="ts"><pre><code><span class="line"><span class="token comment">// app/lib/actions.ts</span></span>
<span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> revalidatePath <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;next/cache&#39;</span></span>
<span class="line"> </span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">updateUser</span><span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token comment">// Mutate data</span></span>
<span class="line">  <span class="token function">revalidatePath</span><span class="token punctuation">(</span><span class="token string">&#39;/profile&#39;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h1 id="error-handling" tabindex="-1"><a class="header-anchor" href="#error-handling"><span>Error Handling</span></a></h1><h2 id="handling-expected-errors" tabindex="-1"><a class="header-anchor" href="#handling-expected-errors"><span>Handling expected errors</span></a></h2><p>Expected errors are those that can occur during the normal operation of the application, such as those from <a href="https://nextjs.org/docs/app/guides/forms" target="_blank" rel="noopener noreferrer">server-side form validation</a> or failed requests. These errors should be handled explicitly and returned to the client.</p><h2 id="handling-uncaught-exceptions" tabindex="-1"><a class="header-anchor" href="#handling-uncaught-exceptions"><span>Handling uncaught exceptions</span></a></h2><p>Uncaught exceptions are unexpected errors that indicate bugs or issues that should not occur during the normal flow of your application. These should be handled by throwing errors, which will then be caught by error boundaries.</p><h3 id="global-errors" tabindex="-1"><a class="header-anchor" href="#global-errors"><span>Global errors</span></a></h3><p>While less common, you can handle errors in the root layout using the <a href="https://nextjs.org/docs/app/api-reference/file-conventions/error#global-error" target="_blank" rel="noopener noreferrer"><code>global-error.js</code></a> file, located in the root app directory, even when leveraging <a href="https://nextjs.org/docs/app/guides/internationalization" target="_blank" rel="noopener noreferrer">internationalization</a>. Global error UI must define its own <code>&lt;html&gt;</code> and <code>&lt;body&gt;</code> tags, since it is replacing the root layout or template when active.</p><h1 id="css" tabindex="-1"><a class="header-anchor" href="#css"><span>CSS</span></a></h1><h2 id="css-modules" tabindex="-1"><a class="header-anchor" href="#css-modules"><span>CSS Modules</span></a></h2><p>CSS Modules locally scope CSS by generating unique class names. This allows you to use the same class in different files without worrying about naming collisions.</p><p>To start using CSS Modules, create a new file with the extension <code>.module.css</code> and import it into any component inside the <code>app</code> directory（it&#39;s not necessary）.</p><h2 id="global-css" tabindex="-1"><a class="header-anchor" href="#global-css"><span>Global CSS</span></a></h2><p>You can use global CSS to apply styles across your application.</p><p>Create a <code>app/global.css</code> file and import it in the root layout to apply the styles to <strong>every route</strong> in your application</p><h1 id="image-optimization" tabindex="-1"><a class="header-anchor" href="#image-optimization"><span>Image Optimization</span></a></h1><p>The Next.js <a href="https://nextjs.org/docs/app/api-reference/components/image" target="_blank" rel="noopener noreferrer"><code>Image</code></a> component extends the HTML <code>&lt;img&gt;</code> element to provide:</p><h2 id="local-images" tabindex="-1"><a class="header-anchor" href="#local-images"><span>Local images</span></a></h2><p>You can store static files, like images and fonts, under a folder called <a href="https://nextjs.org/docs/app/api-reference/file-conventions/public-folder" target="_blank" rel="noopener noreferrer"><code>public</code></a> in the root directory. Files inside <code>public</code> can then be referenced by your code starting from the base URL (<code>/</code>).</p><div class="language-tsx line-numbers-mode" data-highlighter="prismjs" data-ext="tsx" data-title="tsx"><pre><code><span class="line"><span class="token keyword">import</span> Image <span class="token keyword">from</span> <span class="token string">&#39;next/image&#39;</span></span>
<span class="line"> </span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">return</span> <span class="token punctuation">(</span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Image</span></span></span>
<span class="line">      <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/profile.png<span class="token punctuation">&quot;</span></span></span>
<span class="line">      <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Picture of the author<span class="token punctuation">&quot;</span></span></span>
<span class="line">      <span class="token attr-name">width</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token number">500</span><span class="token punctuation">}</span></span></span>
<span class="line">      <span class="token attr-name">height</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token number">500</span><span class="token punctuation">}</span></span></span>
<span class="line">    <span class="token punctuation">/&gt;</span></span></span>
<span class="line">  <span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>If the image is statically imported, Next.js will automatically determine the intrinsic <a href="https://nextjs.org/docs/app/api-reference/components/image#width-and-height" target="_blank" rel="noopener noreferrer"><code>width</code></a> and <a href="https://nextjs.org/docs/app/api-reference/components/image#width-and-height" target="_blank" rel="noopener noreferrer"><code>height</code></a>.</p><div class="language-tsx line-numbers-mode" data-highlighter="prismjs" data-ext="tsx" data-title="tsx"><pre><code><span class="line"><span class="token keyword">import</span> Image <span class="token keyword">from</span> <span class="token string">&#39;next/image&#39;</span></span>
<span class="line"><span class="token keyword">import</span> ProfileImage <span class="token keyword">from</span> <span class="token string">&#39;./profile.png&#39;</span></span>
<span class="line"> </span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">return</span> <span class="token punctuation">(</span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Image</span></span></span>
<span class="line">      <span class="token attr-name">src</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>ProfileImage<span class="token punctuation">}</span></span></span>
<span class="line">      <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Picture of the author<span class="token punctuation">&quot;</span></span></span>
<span class="line">      <span class="token comment">// width={500} automatically provided</span></span>
<span class="line">      <span class="token comment">// height={500} automatically provided</span></span>
<span class="line">      <span class="token comment">// blurDataURL=&quot;data:...&quot; automatically provided</span></span>
<span class="line">      <span class="token comment">// placeholder=&quot;blur&quot; // Optional blur-up while loading</span></span>
<span class="line">    <span class="token punctuation">/&gt;</span></span></span>
<span class="line">  <span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="remote-images" tabindex="-1"><a class="header-anchor" href="#remote-images"><span>Remote images</span></a></h2><p>To use a remote image, you can provide a URL string for the <code>src</code> property.</p><p>Since Next.js does not have access to remote files during the build process, you&#39;ll need to provide the <a href="https://nextjs.org/docs/app/api-reference/components/image#width-and-height" target="_blank" rel="noopener noreferrer"><code>width</code></a>, <a href="https://nextjs.org/docs/app/api-reference/components/image#width-and-height" target="_blank" rel="noopener noreferrer"><code>height</code></a> and optional <a href="https://nextjs.org/docs/app/api-reference/components/image#blurdataurl" target="_blank" rel="noopener noreferrer"><code>blurDataURL</code></a> props manually. Alternatively, you can use the <a href="https://nextjs.org/docs/app/api-reference/components/image#fill" target="_blank" rel="noopener noreferrer"><code>fill</code> property</a> to make the image fill the size of the parent element.</p><div class="language-tsx line-numbers-mode" data-highlighter="prismjs" data-ext="tsx" data-title="tsx"><pre><code><span class="line"><span class="token keyword">import</span> Image <span class="token keyword">from</span> <span class="token string">&#39;next/image&#39;</span></span>
<span class="line"> </span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">return</span> <span class="token punctuation">(</span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Image</span></span></span>
<span class="line">      <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://s3.amazonaws.com/my-bucket/profile.png<span class="token punctuation">&quot;</span></span></span>
<span class="line">      <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Picture of the author<span class="token punctuation">&quot;</span></span></span>
<span class="line">      <span class="token attr-name">width</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token number">500</span><span class="token punctuation">}</span></span></span>
<span class="line">      <span class="token attr-name">height</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token number">500</span><span class="token punctuation">}</span></span></span>
<span class="line">    <span class="token punctuation">/&gt;</span></span></span>
<span class="line">  <span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>To safely allow images from remote servers, you need to define a list of supported URL patterns in <a href="https://nextjs.org/docs/app/api-reference/config/next-config-js" target="_blank" rel="noopener noreferrer"><code>next.config.js</code></a>.</p><div class="language-tsx line-numbers-mode" data-highlighter="prismjs" data-ext="tsx" data-title="tsx"><pre><code><span class="line"><span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span> NextConfig <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;next&#39;</span></span>
<span class="line"> </span>
<span class="line"><span class="token keyword">const</span> config<span class="token operator">:</span> NextConfig <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  images<span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">    remotePatterns<span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line">      <span class="token punctuation">{</span></span>
<span class="line">        protocol<span class="token operator">:</span> <span class="token string">&#39;https&#39;</span><span class="token punctuation">,</span></span>
<span class="line">        hostname<span class="token operator">:</span> <span class="token string">&#39;s3.amazonaws.com&#39;</span><span class="token punctuation">,</span></span>
<span class="line">        port<span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span></span>
<span class="line">        pathname<span class="token operator">:</span> <span class="token string">&#39;/my-bucket/**&#39;</span><span class="token punctuation">,</span></span>
<span class="line">        search<span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"> </span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> config</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>When <strong>using</strong> a remote image with the <code>Image</code> component by setting the image URL in the <code>src</code> property, the user&#39;s browser <strong>doesn&#39;t</strong> send a request directly to the URL, but <strong>instead sends it</strong> to the Next.js project server</p></blockquote><h1 id="font-optimization" tabindex="-1"><a class="header-anchor" href="#font-optimization"><span>Font Optimization</span></a></h1><p>The <a href="https://nextjs.org/docs/app/api-reference/components/font" target="_blank" rel="noopener noreferrer"><code>next/font</code></a> module automatically optimizes your fonts and removes external network requests for improved privacy and performance.</p><h2 id="google-fonts" tabindex="-1"><a class="header-anchor" href="#google-fonts"><span>Google fonts</span></a></h2><p>You can automatically self-host any Google Font. Fonts are included stored as static assets and served from the same domain as your deployment, meaning no requests are sent to Google by the browser when the user visits your site.</p><div class="language-tsx line-numbers-mode" data-highlighter="prismjs" data-ext="tsx" data-title="tsx"><pre><code><span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> Geist <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;next/font/google&#39;</span></span>
<span class="line"> </span>
<span class="line"><span class="token keyword">const</span> geist <span class="token operator">=</span> <span class="token function">Geist</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">  subsets<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;latin&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"> </span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">RootLayout</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">  children<span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">  children<span class="token operator">:</span> React<span class="token punctuation">.</span>ReactNode</span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">return</span> <span class="token punctuation">(</span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span> <span class="token attr-name">className</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>geist<span class="token punctuation">.</span>className<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text"></span>
<span class="line">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>children<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span><span class="token plain-text"></span>
<span class="line">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">  <span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="local-fonts" tabindex="-1"><a class="header-anchor" href="#local-fonts"><span>Local fonts</span></a></h2><p>To use a local font, import your font from <code>next/font/local</code> and specify the <a href="https://nextjs.org/docs/app/api-reference/components/font#src" target="_blank" rel="noopener noreferrer"><code>src</code></a> of your local font file. Fonts can be stored in the <a href="https://nextjs.org/docs/app/api-reference/file-conventions/public-folder" target="_blank" rel="noopener noreferrer"><code>public</code></a> folder or co-located inside the <code>app</code> folder. For example:</p><div class="language-tsx line-numbers-mode" data-highlighter="prismjs" data-ext="tsx" data-title="tsx"><pre><code><span class="line"><span class="token keyword">import</span> localFont <span class="token keyword">from</span> <span class="token string">&#39;next/font/local&#39;</span></span>
<span class="line"> </span>
<span class="line"><span class="token keyword">const</span> myFont <span class="token operator">=</span> <span class="token function">localFont</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">  src<span class="token operator">:</span> <span class="token string">&#39;./my-font.woff2&#39;</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"> </span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">RootLayout</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">  children<span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">}</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">  children<span class="token operator">:</span> React<span class="token punctuation">.</span>ReactNode</span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">return</span> <span class="token punctuation">(</span></span>
<span class="line">    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span> <span class="token attr-name">className</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>myFont<span class="token punctuation">.</span>className<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text"></span>
<span class="line">      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>children<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span><span class="token plain-text"></span>
<span class="line">    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">  <span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>The <code>localFont</code> function must be declared at the top of the module (in other words, at the top of the file), and its <code>src</code> value <strong>cannot be</strong> a path alias (e.g., <code>@/fonts/my-font.woff2</code>).</p></blockquote><h1 id="metadata-and-og-images" tabindex="-1"><a class="header-anchor" href="#metadata-and-og-images"><span>Metadata and OG images</span></a></h1><p>The Metadata APIs can be used to define your application metadata for improved SEO and web shareability</p><h2 id="default-fields" tabindex="-1"><a class="header-anchor" href="#default-fields"><span>Default fields</span></a></h2><p>There are two default <code>meta</code> tags that are always added even if a route doesn&#39;t define metadata:</p><div class="language-html line-numbers-mode" data-highlighter="prismjs" data-ext="html" data-title="html"><pre><code><span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>utf-8<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>width=device-width, initial-scale=1<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="static-metadata" tabindex="-1"><a class="header-anchor" href="#static-metadata"><span>Static metadata</span></a></h2><p>To define static metadata, export a <a href="https://nextjs.org/docs/app/api-reference/functions/generate-metadata#metadata-object" target="_blank" rel="noopener noreferrer"><code>Metadata</code> object</a> from a static <a href="https://nextjs.org/docs/app/api-reference/file-conventions/layout" target="_blank" rel="noopener noreferrer"><code>layout.js</code></a> or <a href="https://nextjs.org/docs/app/api-reference/file-conventions/page" target="_blank" rel="noopener noreferrer"><code>page.js</code></a> file. For example, to add a title and description to the blog route:</p><div class="language-tsx line-numbers-mode" data-highlighter="prismjs" data-ext="tsx" data-title="tsx"><pre><code><span class="line"><span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span> Metadata <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;next&#39;</span></span>
<span class="line"> </span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">const</span> metadata<span class="token operator">:</span> Metadata <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  title<span class="token operator">:</span> <span class="token string">&#39;My Blog&#39;</span><span class="token punctuation">,</span></span>
<span class="line">  description<span class="token operator">:</span> <span class="token string">&#39;...&#39;</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"> </span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="generated-metadata" tabindex="-1"><a class="header-anchor" href="#generated-metadata"><span>Generated metadata</span></a></h2><p>You can use <a href="https://nextjs.org/docs/app/api-reference/functions/generate-metadata" target="_blank" rel="noopener noreferrer"><code>generateMetadata</code></a> function to <code>fetch</code> metadata that depends on data. For example, to fetch the title and description for a specific blog post:</p><div class="language-tsx line-numbers-mode" data-highlighter="prismjs" data-ext="tsx" data-title="tsx"><pre><code><span class="line"><span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span> Metadata<span class="token punctuation">,</span> ResolvingMetadata <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;next&#39;</span></span>
<span class="line"> </span>
<span class="line"><span class="token keyword">type</span> <span class="token class-name">Props</span> <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  params<span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token punctuation">{</span> slug<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">}</span><span class="token operator">&gt;</span></span>
<span class="line">  searchParams<span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token punctuation">{</span> <span class="token punctuation">[</span>key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">|</span> <span class="token keyword">undefined</span> <span class="token punctuation">}</span><span class="token operator">&gt;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"> </span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">generateMetadata</span><span class="token punctuation">(</span></span>
<span class="line">  <span class="token punctuation">{</span> params<span class="token punctuation">,</span> searchParams <span class="token punctuation">}</span><span class="token operator">:</span> Props<span class="token punctuation">,</span></span>
<span class="line">  parent<span class="token operator">:</span> ResolvingMetadata</span>
<span class="line"><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>Metadata<span class="token operator">&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">const</span> slug <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">await</span> params<span class="token punctuation">)</span><span class="token punctuation">.</span>slug</span>
<span class="line"> </span>
<span class="line">  <span class="token comment">// fetch post information</span></span>
<span class="line">  <span class="token keyword">const</span> post <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">https://api.vercel.app/blog/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>slug<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token operator">=&gt;</span></span>
<span class="line">    res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">)</span></span>
<span class="line"> </span>
<span class="line">  <span class="token keyword">return</span> <span class="token punctuation">{</span></span>
<span class="line">    title<span class="token operator">:</span> post<span class="token punctuation">.</span>title<span class="token punctuation">,</span></span>
<span class="line">    description<span class="token operator">:</span> post<span class="token punctuation">.</span>description<span class="token punctuation">,</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"> </span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span> params<span class="token punctuation">,</span> searchParams <span class="token punctuation">}</span><span class="token operator">:</span> Props<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="streaming-metadata" tabindex="-1"><a class="header-anchor" href="#streaming-metadata"><span>Streaming metadata</span></a></h3><p>For dynamically rendered pages, if resolving <code>generateMetadata</code> might block rendering, Next.js streams the resolved metadata separately and injects it into the HTML as soon as it&#39;s ready.</p><p>Statically rendered pages don’t use this behavior since metadata is resolved at build time.</p><p>Learn more about <a href="https://nextjs.org/docs/app/api-reference/functions/generate-metadata#streaming-metadata" target="_blank" rel="noopener noreferrer">streaming metadata</a>.</p><h3 id="memoizing-data-requests" tabindex="-1"><a class="header-anchor" href="#memoizing-data-requests"><span>Memoizing data requests</span></a></h3><p>There may be cases where you need to fetch the <strong>same</strong> data for metadata and the page itself. To avoid duplicate requests, you can use React&#39;s <a href="https://react.dev/reference/react/cache" target="_blank" rel="noopener noreferrer"><code>cache</code> function</a> to memoize the return value and only fetch the data once. For example, to fetch the blog post information for both the metadata and the page:</p><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts" data-title="ts"><pre><code><span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> cache <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;react&#39;</span></span>
<span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> db <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@/app/lib/db&#39;</span></span>
<span class="line"> </span>
<span class="line"><span class="token comment">// getPost will be used twice, but execute only once</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">const</span> getPost <span class="token operator">=</span> <span class="token function">cache</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span>slug<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> db<span class="token punctuation">.</span>query<span class="token punctuation">.</span>posts<span class="token punctuation">.</span><span class="token function">findFirst</span><span class="token punctuation">(</span><span class="token punctuation">{</span> where<span class="token operator">:</span> <span class="token function">eq</span><span class="token punctuation">(</span>posts<span class="token punctuation">.</span>slug<span class="token punctuation">,</span> slug<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token keyword">return</span> res</span>
<span class="line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="static-open-graph-images" tabindex="-1"><a class="header-anchor" href="#static-open-graph-images"><span>Static Open Graph images</span></a></h2><p>Open Graph (OG) images are images that represent your site in social media. To add a static OG image to your application, create a <code>opengraph-image.png</code> file in the root of the app folder.</p><p>You can also add OG images for specific routes by creating a <code>opengraph-image.png</code> deeper down the folder structure.</p><h2 id="generated-open-graph-images" tabindex="-1"><a class="header-anchor" href="#generated-open-graph-images"><span>Generated Open Graph images</span></a></h2><p>The <a href="https://nextjs.org/docs/app/api-reference/functions/image-response" target="_blank" rel="noopener noreferrer"><code>ImageResponse</code> constructor</a> allows you to generate dynamic images using JSX and CSS. This is useful for OG images that depend on data.</p><p>For example, to generate a unique OG image for each blog post, add a <code>opengraph-image.ts</code> file inside the <code>blog</code> folder, and import the <code>ImageResponse</code> constructor from <code>next/og</code>:</p><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts" data-title="ts"><pre><code><span class="line"><span class="token comment">// app/blog/[slug]/opengraph-image.ts</span></span>
<span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> ImageResponse <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;next/og&#39;</span></span>
<span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> getPost <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@/app/lib/data&#39;</span></span>
<span class="line"> </span>
<span class="line"><span class="token comment">// Image metadata</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">const</span> size <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  width<span class="token operator">:</span> <span class="token number">1200</span><span class="token punctuation">,</span></span>
<span class="line">  height<span class="token operator">:</span> <span class="token number">630</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"> </span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">const</span> contentType <span class="token operator">=</span> <span class="token string">&#39;image/png&#39;</span></span>
<span class="line"> </span>
<span class="line"><span class="token comment">// Image generation</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">Image</span><span class="token punctuation">(</span><span class="token punctuation">{</span> params <span class="token punctuation">}</span><span class="token operator">:</span> <span class="token punctuation">{</span> params<span class="token operator">:</span> <span class="token punctuation">{</span> slug<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">const</span> post <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getPost</span><span class="token punctuation">(</span>params<span class="token punctuation">.</span>slug<span class="token punctuation">)</span></span>
<span class="line"> </span>
<span class="line">  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ImageResponse</span><span class="token punctuation">(</span></span>
<span class="line">    <span class="token punctuation">(</span></span>
<span class="line">      <span class="token comment">// ImageResponse JSX element</span></span>
<span class="line">      <span class="token operator">&lt;</span>div</span>
<span class="line">        style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span></span>
<span class="line">          fontSize<span class="token operator">:</span> <span class="token number">128</span><span class="token punctuation">,</span></span>
<span class="line">          background<span class="token operator">:</span> <span class="token string">&#39;white&#39;</span><span class="token punctuation">,</span></span>
<span class="line">          width<span class="token operator">:</span> <span class="token string">&#39;100%&#39;</span><span class="token punctuation">,</span></span>
<span class="line">          height<span class="token operator">:</span> <span class="token string">&#39;100%&#39;</span><span class="token punctuation">,</span></span>
<span class="line">          display<span class="token operator">:</span> <span class="token string">&#39;flex&#39;</span><span class="token punctuation">,</span></span>
<span class="line">          alignItems<span class="token operator">:</span> <span class="token string">&#39;center&#39;</span><span class="token punctuation">,</span></span>
<span class="line">          justifyContent<span class="token operator">:</span> <span class="token string">&#39;center&#39;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">      <span class="token operator">&gt;</span></span>
<span class="line">        <span class="token punctuation">{</span>post<span class="token punctuation">.</span>title<span class="token punctuation">}</span></span>
<span class="line">      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span></span>
<span class="line">    <span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><code>ImageResponse</code> supports common CSS properties including flexbox and absolute positioning, custom fonts, text wrapping, centering, and nested images. <a href="https://nextjs.org/docs/app/api-reference/functions/image-response" target="_blank" rel="noopener noreferrer">See the full list of supported CSS properties</a>.</p></blockquote><h1 id="route-handlers-and-middleware" tabindex="-1"><a class="header-anchor" href="#route-handlers-and-middleware"><span>Route Handlers and Middleware</span></a></h1><h2 id="route-handlers" tabindex="-1"><a class="header-anchor" href="#route-handlers"><span>Route Handlers</span></a></h2><p>Route Handlers allow you to create custom request handlers for a given route using the Web <a href="https://developer.mozilla.org/docs/Web/API/Request" target="_blank" rel="noopener noreferrer">Request</a> and <a href="https://developer.mozilla.org/docs/Web/API/Response" target="_blank" rel="noopener noreferrer">Response</a> APIs.</p><p><img src="/assets/image-20250703084912732-CyiEFQA1.png" alt="image-20250703084912732"></p><h3 id="convention" tabindex="-1"><a class="header-anchor" href="#convention"><span>Convention</span></a></h3><p>Route Handlers are defined in a <a href="https://nextjs.org/docs/app/api-reference/file-conventions/route" target="_blank" rel="noopener noreferrer"><code>route.js|ts</code> file</a> inside the <code>app</code> directory.</p><p>Route Handlers can be nested anywhere inside the <code>app</code> directory, similar to <code>page.js</code> and <code>layout.js</code>. But there <strong>cannot</strong> be a <code>route.js</code> file at the same route segment level as <code>page.js</code>.</p><h3 id="supported-http-methods" tabindex="-1"><a class="header-anchor" href="#supported-http-methods"><span>Supported HTTP Methods</span></a></h3><p>The following <a href="https://developer.mozilla.org/docs/Web/HTTP/Methods" target="_blank" rel="noopener noreferrer">HTTP methods</a> are supported: <code>GET</code>, <code>POST</code>, <code>PUT</code>, <code>PATCH</code>, <code>DELETE</code>, <code>HEAD</code>, and <code>OPTIONS</code>. If an unsupported method is called, Next.js will return a <code>405 Method Not Allowed</code> response.</p><h3 id="extended-nextrequest-and-nextresponse-apis" tabindex="-1"><a class="header-anchor" href="#extended-nextrequest-and-nextresponse-apis"><span>Extended NextRequest and NextResponse APIs</span></a></h3><p>In addition to supporting the native <a href="https://developer.mozilla.org/docs/Web/API/Request" target="_blank" rel="noopener noreferrer">Request</a> and <a href="https://developer.mozilla.org/docs/Web/API/Response" target="_blank" rel="noopener noreferrer">Response</a> APIs, Next.js extends them with <a href="https://nextjs.org/docs/app/api-reference/functions/next-request" target="_blank" rel="noopener noreferrer"><code>NextRequest</code></a> and <a href="https://nextjs.org/docs/app/api-reference/functions/next-response" target="_blank" rel="noopener noreferrer"><code>NextResponse</code></a> to provide convenient helpers for advanced use cases.</p><h3 id="caching" tabindex="-1"><a class="header-anchor" href="#caching"><span>Caching</span></a></h3><p>Route Handlers are not cached by default. You can, however, opt into caching for <code>GET</code> methods. Other supported HTTP methods are <strong>not</strong> cached. To cache a <code>GET</code> method, use a <a href="https://nextjs.org/docs/app/api-reference/file-conventions/route-segment-config#dynamic" target="_blank" rel="noopener noreferrer">route config option</a> such as <code>export const dynamic = &#39;force-static&#39;</code> in your Route Handler file.</p><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts" data-title="ts"><pre><code><span class="line"><span class="token keyword">export</span> <span class="token keyword">const</span> dynamic <span class="token operator">=</span> <span class="token string">&#39;force-static&#39;</span></span>
<span class="line"> </span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token constant">GET</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&#39;https://data.mongodb-api.com/...&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span></span>
<span class="line">    headers<span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token string-property property">&#39;Content-Type&#39;</span><span class="token operator">:</span> <span class="token string">&#39;application/json&#39;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token string-property property">&#39;API-Key&#39;</span><span class="token operator">:</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">DATA_API_KEY</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token keyword">await</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"> </span>
<span class="line">  <span class="token keyword">return</span> Response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">{</span> data <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p><strong>Good to know</strong>: Other supported HTTP methods are <strong>not</strong> cached, even if they are placed alongside a <code>GET</code> method that is cached, in the same file.</p></blockquote><h3 id="special-route-handlers" tabindex="-1"><a class="header-anchor" href="#special-route-handlers"><span>Special Route Handlers</span></a></h3><p>Special Route Handlers like <a href="https://nextjs.org/docs/app/api-reference/file-conventions/metadata/sitemap" target="_blank" rel="noopener noreferrer"><code>sitemap.ts</code></a>, <a href="https://nextjs.org/docs/app/api-reference/file-conventions/metadata/opengraph-image" target="_blank" rel="noopener noreferrer"><code>opengraph-image.tsx</code></a>, and <a href="https://nextjs.org/docs/app/api-reference/file-conventions/metadata/app-icons" target="_blank" rel="noopener noreferrer"><code>icon.tsx</code></a>, and other <a href="https://nextjs.org/docs/app/api-reference/file-conventions/metadata" target="_blank" rel="noopener noreferrer">metadata files</a> remain static by default unless they use Dynamic APIs or dynamic config options.</p><h3 id="route-resolution" tabindex="-1"><a class="header-anchor" href="#route-resolution"><span>Route Resolution</span></a></h3><p>You can consider a <code>route</code> the lowest level routing primitive.</p><ul><li>They <strong>do not</strong> participate in layouts or client-side navigations like <code>page</code>.</li><li>There <strong>cannot</strong> be a <code>route.js</code> file at the same route as <code>page.js</code>.</li></ul><p>Each <code>route.js</code> or <code>page.js</code> file takes over all HTTP verbs for that route.</p><h2 id="middleware" tabindex="-1"><a class="header-anchor" href="#middleware"><span>Middleware</span></a></h2><p>Middleware allows you to run code before a request is completed. Then, based on the incoming request, you can modify the response by rewriting, redirecting, modifying the request or response headers, or responding directly.</p><h3 id="use-cases" tabindex="-1"><a class="header-anchor" href="#use-cases"><span>Use cases</span></a></h3><p>Some common scenarios where Middleware is effective include:</p><ul><li>Quick redirects after reading parts of the incoming request</li><li>Rewriting to different pages based on A/B tests or experiments</li><li>Modifying headers for all pages or a subset of pages</li></ul><p>Middleware is <em>not</em> a good fit for:</p><ul><li>Slow data fetching</li><li>Session management</li></ul><p>Using fetch with <code>options.cache</code>, <code>options.next.revalidate</code>, or <code>options.next.tags</code>, has no effect in Middleware.</p><h3 id="convention-1" tabindex="-1"><a class="header-anchor" href="#convention-1"><span>Convention</span></a></h3><p>Use the file <code>middleware.ts</code> (or <code>.js</code>) in the root of your project to define Middleware. For example, at the same level as <code>pages</code> or <code>app</code>, or inside <code>src</code> if applicable.</p><blockquote><p><strong>Note</strong>: While only one <code>middleware.ts</code> file is supported per project, you can still organize your middleware logic into modules. Break out middleware functionalities into separate <code>.ts</code> or <code>.js</code> files and import them into your main <code>middleware.ts</code> file. This allows for cleaner management of route-specific middleware, aggregated in the <code>middleware.ts</code> for centralized control. By enforcing a single middleware file, it simplifies configuration, prevents potential conflicts, and optimizes performance by avoiding multiple middleware layers.</p></blockquote><h3 id="example-1" tabindex="-1"><a class="header-anchor" href="#example-1"><span>Example</span></a></h3><div class="language-typescript line-numbers-mode" data-highlighter="prismjs" data-ext="ts" data-title="ts"><pre><code><span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span> NextResponse <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;next/server&#39;</span></span>
<span class="line"><span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{</span> NextRequest <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;next/server&#39;</span></span>
<span class="line"> </span>
<span class="line"><span class="token comment">// This function can be marked `async` if using `await` inside</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">middleware</span><span class="token punctuation">(</span>request<span class="token operator">:</span> NextRequest<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">return</span> NextResponse<span class="token punctuation">.</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name"><span class="token constant">URL</span></span><span class="token punctuation">(</span><span class="token string">&#39;/home&#39;</span><span class="token punctuation">,</span> request<span class="token punctuation">.</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"> </span>
<span class="line"><span class="token comment">// See &quot;Matching Paths&quot; below to learn more</span></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token comment">// matcher 告诉中间件只在这些路径上运行</span></span>
<span class="line">  <span class="token comment">// `*` 表示匹配单个路径段</span></span>
<span class="line">  <span class="token comment">// `+` 表示匹配一个或多个路径段</span></span>
<span class="line">  <span class="token comment">// `?` 表示匹配零个或一个路径段</span></span>
<span class="line">  <span class="token comment">// `:path*` 表示匹配所有后续路径</span></span>
<span class="line">  matcher<span class="token operator">:</span> <span class="token string">&#39;/about/:path*&#39;</span><span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Read more about <a href="https://nextjs.org/docs/app/guides/backend-for-frontend#middleware" target="_blank" rel="noopener noreferrer">using <code>middleware</code></a>, or refer to the <code>middleware</code> <a href="https://nextjs.org/docs/app/api-reference/file-conventions/middleware" target="_blank" rel="noopener noreferrer">API reference</a>.</p></div><!--[--><!--]--></div><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><div class="vp-meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="vp-meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: 1308811723@qq.com">RuanCong</span><!--[-->, <!--]--><!--]--><!--[--><span class="contributor" title="email: ruancong130@gmail.com">Leite</span><!----><!--]--><!--]--></span></div></div></footer><!----><!--[--><!--]--></main><!--]--></div><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-BNa-KI3k.js" defer></script>
  </body>
</html>
